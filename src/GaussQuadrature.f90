SUBROUTINE GaussQuadratureq(i, a, b, integral_result) 
  ! Perform 512-pt Gaussian-Legemdre quadrature to evaluate integral
  USE ISO_C_BINDING, ONLY: C_INT, C_DOUBLE
  USE Integrands_MOD, ONLY: Integrands
  
  IMPLICIT NONE
  REAL(KIND=C_DOUBLE), INTENT(IN)   :: a, b      ! Integration limits
  REAL(KIND=C_DOUBLE), INTENT(OUT)  :: integral_result
  INTEGER(C_INT), INTENT(IN)        :: i

  INTEGER                               :: j, npoints
  REAL(KIND=C_DOUBLE)                   :: xu, xl, fl, fu
  REAL(KIND=C_DOUBLE), PARAMETER, DIMENSION(256) :: absc = &
    (/ 0.003064962185159399599837515282D00, &
       0.009194771386432905660446301965D00, &
       0.015324235084898182521206955187D00, &
       0.021453122959774875710969865850D00, &
       0.027581204711919792005314633343D00, &
       0.033708250072480593073631638390D00, &
       0.039834028811548446991075422829D00, &
       0.045958310746809061253514983036D00, &
       0.052080865752192069539905361353D00, &
       0.058201463766518225784185602834D00, &
       0.064319874802144239023249383536D00, &
       0.070435868953604666153900382142D00, &
       0.076549216406251049948927800415D00, &
       0.082659687444887164353701791697D00, &
       0.088767052462401033197103572547D00, &
       0.094871081968392542704826553290D00, &
       0.100971546597796779654032661711D00, &
       0.107068217119502664957941817647D00, &
       0.113160864444966535735659363127D00, &
       0.119249259636820398311485291742D00, &
       0.125333173917474477443434466295D00, &
       0.131412378677713714836272629327D00, &
       0.137486645485288105916765744041D00, &
       0.143555746093496028326086388915D00, &
       0.149619452449761269896555404557D00, &
       0.155677536704201868733576930026D00, &
       0.161729771218192097670396378817D00, &
       0.167775928572916122050173726166D00, &
       0.173815781577913441857674570201D00, &
       0.179849103279615923911549657532D00, &
       0.185875666969875702472236866925D00, &
       0.191895246194484031532212497950D00, &
       0.197907614761680478165928320777D00, &
       0.203912546750652373672707540209D00, &
       0.209909816520023939645511745766D00, &
       0.215899198716335033454427616562D00, &
       0.221880468282509041300087915261D00, &
       0.227853400466309585770119383596D00, &
       0.233817770828785853609588230029D00, &
       0.239773355252706182882960206371D00, &
       0.245719929950979243393760498293D00, &
       0.251657271475063337717870126653D00, &
       0.257585156723362629360707387605D00, &
       0.263503362949610298038294331491D00, &
       0.269411667771238594326632664888D00, &
       0.275309849177735044278847453825D00, &
       0.281197685538984665232220550024D00, &
       0.287074955613597970760508815147D00, &
       0.292941438557224431704639755480D00, &
       0.298796913930850727147969791986D00, &
       0.304641161709084229425315015760D00, &
       0.310473962288420446409276109989D00, &
       0.316295096495494865163067288449D00, &
       0.322104345595318808381790631756D00, &
       0.327901491299498415443736121233D00, &
       0.333686315774437136649765989205D00, &
       0.339458601649521019005817379366D00, &
       0.345218132025286672526220854706D00, &
       0.350964690481571417457473671675D00, &
       0.356698061085645612422467820579D00, &
       0.362418028400326441840206825873D00, &
       0.368124377492073107109860075070D00, &
       0.373816893939063366048003445030D00, &
       0.379495363839250532400626525487D00, &
       0.385159573818401101963360133595D00, &
       0.390809311038112505709563038181D00, &
       0.396444363203810545837058043617D00, &
       0.402064518572726958822727283405D00, &
       0.407669565961855551172732248233D00, &
       0.413259294755887629513324554864D00, &
       0.418833494915126280933037605791D00, &
       0.424391956983378670908990670796D00, &
       0.429934472095826580861910315434D00, &
       0.435460831986874741250659326397D00, &
       0.440970828997976571628214514931D00, &
       0.446464256085437494192547092098D00, &
       0.451940906828194099986717446882D00, &
       0.457400575435571277171931114935D00, &
       0.462843056755014803371750531369D00, &
       0.468268146279799957198974880157D00, &
       0.473675640156716648565549121486D00, &
       0.479065335193728458751394327919D00, &
       0.484437028867608643345477048570D00, &
       0.489790519331549878412346288314D00, &
       0.495125605422748638062557802186D00, &
       0.500442086669964369960439398710D00, &
       0.505739763301052192012718933256D00, &
       0.511018436250469942905283460277D00, &
       0.516277907166757477064322756632D00, &
       0.521517978419990813065965085116D00, &
       0.526738453109207749314180091460D00, &
       0.531939135069806612321485772554D00, &
       0.537119828880917804525552128325D00, &
       0.542280339872746153240257172001D00, &
       0.547420474133886614254151936620D00, &
       0.552540038518610221451865527342D00, &
       0.557638840654121947792987157300D00, &
       0.562716688947789034358493154286D00, &
       0.567773392594340675643138638407D00, &
       0.572808761583037395759276932949D00, &
       0.577822606704811114752828871133D00, &
       0.582814739559374461741469986009D00, &
       0.587784972562300778164967596240D00, &
       0.592733118952072146612408687361D00, &
       0.597658992797097665672367838852D00, &
       0.602562409002699417293058559153D00, &
       0.607443183318068347098517278937D00, &
       0.612301132343186949036351052200D00, &
       0.617136073535721196847703140520D00, &
       0.621947825217879390891084767645D00, &
       0.626736206583239252587702594610D00, &
       0.631501037703541601153744977637D00, &
       0.636242139535451722842651633982D00, &
       0.640959333927286434295922390447D00, &
       0.645652443625708949426211802347D00, &
       0.650321292282389107342055467598D00, &
       0.654965704460630293581857586105D00, &
       0.659585505641960279099578201567D00, &
       0.664180522232690528916521088831D00, &
       0.668750581570438429324099161022D00, &
       0.673295511930615209195138959331D00, &
       0.677815142532878778247606987861D00, &
       0.682309303547550927149245580949D00, &
       0.686777826101999111507723227987D00, &
       0.691220542286981598500972268084D00, &
       0.695637285162956975348436117201D00, &
       0.700027888766357242467108790152D00, &
       0.704392188115823825178551942372D00, &
       0.708730019218407059078401744046D00, &
       0.713041219075728482934550811478D00, &
       0.717325625690105272980190420640D00, &
       0.721583078070637928824737628020D00, &
       0.725813416239259323603505436040D00, &
       0.730016481236746561656048015720D00, &
       0.734192115128692979197921886225D00, &
       0.738340161011444173766449239338D00, &
       0.742460463017992289280755358050D00, &
       0.746552866323834107831203255046D00, &
       0.750617217152788063216917180398D00, &
       0.754653362782772507699746711296D00, &
       0.758661151551544898907764036267D00, &
       0.762640432862400241553757496149D00, &
       0.766591057189829894191746006982D00, &
       0.770512876085140518966909439769D00, &
       0.774405742182031731069002944423D00, &
       0.778269509202133780156884768076D00, &
       0.782104031960504153531132942589D00, &
       0.785909166371082990032448378770D00, &
       0.789684769452107193643541904748D00, &
       0.793430699331483024749900323513D00, &
       0.797146815252117502126338877133D00, &
       0.800832977577207061337105642451D00, &
       0.804489047795484579772562483413D00, &
       0.808114888526424324233232709958D00, &
       0.811710363525404265949703130900D00, &
       0.815275337688824874859960800677D00, &
       0.818809677059186835634818635299D00, &
       0.822313248830123577626238784433D00, &
       0.825785921351392504519139947661D00, &
       0.829227564133821259950707371900D00, &
       0.832638047854211360565557242808D00, &
       0.836017244360197420149916069931D00, &
       0.839365026675062742000932303199D00, &
       0.842681269002510502375002943154D00, &
       0.845965846731390636037417607440D00, &
       0.849218636440382645957924978575D00, &
       0.852439515902632671817684695270D00, &
       0.855628364090346482662141625042D00, &
       0.858785061179337283476797892945D00, &
       0.861909488553529001819697441533D00, &
       0.865001528809411501796944321541D00, &
       0.868061065760453942630192614160D00, &
       0.871087984441469842522565159015D00, &
       0.874082171112937289514377425803D00, &
       0.877043513265272300927222204336D00, &
       0.879971899623057107753254513227D00, &
       0.882867220149221032521325014386D00, &
       0.885729366049175403929893946042D00, &
       0.888558229774901842112910799187D00, &
       0.891353705028992693293332649773D00, &
       0.894115686768646500404145172070D00, &
       0.896844071209613846740182907524D00, &
       0.899538755830097902510544827237D00, &
       0.902199639374606787711741162639D00, &
       0.904826621857757973366176429408D00, &
       0.907419604568035498282085882238D00, &
       0.909978490071499224178808162833D00, &
       0.912503182215446018155091678636D00, &
       0.914993586132022862500434712274D00, &
       0.917449608241791114693342024111D00, &
       0.919871156257243582921034885658D00, &
       0.922258139186271863607657905959D00, &
       0.924610467335585606285519588710D00, &
       0.926928052314082817630946919962D00, &
       0.929210807036171093642451523920D00, &
       0.931458645725040335072719699383D00, &
       0.933671483915885391802191861643D00, &
       0.935849238459080523533373252576D00, &
       0.937991827523303123292919281084D00, &
       0.940099170598609368276754594262D00, &
       0.942171188499458911458361853875D00, &
       0.944207803367690501339382080914D00, &
       0.946208938675447974731014255667D00, &
       0.948174519228055068253979698056D00, &
       0.950104471166841935136915253679D00, &
       0.951998721971919814599516485032D00, &
       0.953857200464905963244177655724D00, &
       0.955679836811598848456128507678D00, &
       0.957466562524601938477530893579D00, &
       0.959217310465897199378559889738D00, &
       0.960932014849367743813957076782D00, &
       0.962610611243270297698870763270D00, &
       0.964253036572656041514051139529D00, &
       0.965859229121740714418820061837D00, &
       0.967429128536223759127210541919D00, &
       0.968962675825556618569578404276D00, &
       0.970459813365158741049754098640D00, &
       0.971920484898583625366086380382D00, &
       0.973344635539632463405723683536D00, &
       0.974732211774417045546670124168D00, &
       0.976083161463370263533079196350D00, &
       0.977397433843205876158322098490D00, &
       0.978674979528826316510503602331D00, &
       0.979915750515178207713518077071D00, &
       0.981119700179057141475880143844D00, &
       0.982286783280859610023583172733D00, &
       0.983416955966283978796127485111D00, &
       0.984510175767978390481971473491D00, &
       0.985566401607137931861757351726D00, &
       0.986585593795049176080169672787D00, &
       0.987567714034582877502543851733D00, &
       0.988512725421635041200829618901D00, &
       0.989420592446515700935094628221D00, &
       0.990291280995286848920500233362D00, &
       0.991124758351048074089817419008D00, &
       0.991920993195171463163717362477D00, &
       0.992679955608486541684953863296D00, &
       0.993401617072414810927227790671D00, &
       0.994085950470055879080177874130D00, &
       0.994732930087228184312664325262D00, &
       0.995342531613465753004277303262D00, &
       0.995914732142977210394008125149D00, &
       0.996449510175577368720212234621D00, &
       0.996946845617603827349739731289D00, &
       0.997406719782849782163225427212D00, &
       0.997829115393562893210344100225D00, &
       0.998214016581612795242506308568D00, &
       0.998561408890039747809908021736D00, &
       0.998871279275449386325647083140D00, &
       0.999143616112378230020851788140D00, &
       0.999378409202599238270181558619D00, &
       0.999575649798310816862567662611D00, &
       0.999735330671042699002271092468D00, &
       0.999857446369979419031892575731D00, &
       0.999941994606845629967040167685D00, &
       0.999988990984381875826159102871D00 /)
  
  
  REAL(KIND=C_DOUBLE), PARAMETER, DIMENSION(256) :: weights = (/ &
      0.006129905175405764294893629085D0, &
      0.006129674838036492517945319491D0, &
      0.006129214171953068987508395082D0, &
      0.006128523194465529920493818139D0, &
      0.006127601931538031489188345091D0, &
      0.006126450417787949499770494555D0, &
      0.006125068696484561869830542946D0, &
      0.006123456819547496918221263229D0, &
      0.006121614847544605726714639360D0, &
      0.006119542849689838838467270676D0, &
      0.006117240903840640703359454733D0, &
      0.006114709096494903503571372028D0, &
      0.006111947522787882815242799239D0, &
      0.006108956286488514790533610466D0, &
      0.006105735499995448845034218266D0, &
      0.006102285284333060395856040969D0, &
      0.006098605769146656953305640769D0, &
      0.006094697092697685079920599804D0, &
      0.006090559401858643313876218173D0, &
      0.006086192852107506767733724473D0, &
      0.006081597607521639116401335201D0, &
      0.006076773840772089693706980995D0, &
      0.006071721733116766488158599913D0, &
      0.006066441474393663782493923975D0, &
      0.006060933263013820911091489307D0, &
      0.006055197305953895908769979428D0, &
      0.006049233818748141547350094527D0, &
      0.006043043025480822859341056841D0, &
      0.006036625158776993613218841972D0, &
      0.006029980459794644954973907858D0, &
      0.006023109178214984885113558732D0, &
      0.006016011572233289327049643447D0, &
      0.006008687908549399311897154519D0, &
      0.006001138462357170390293337192D0, &
      0.005993363517334814559445188564D0, &
      0.005985363365633674000154673678D0, &
      0.005977138307867538649653660343D0, &
      0.005968688653101249068366751516D0, &
      0.005960014718839098078750904364D0, &
      0.005951116831012847295523382485D0, &
      0.005941995323969674266950669050D0, &
      0.005932650540459486442068648415D0, &
      0.005923082831621807528565959444D0, &
      0.005913292556972981305063452595D0, &
      0.005903280084392509806379134574D0, &
      0.005893045790109107881504790782D0, &
      0.005882590058686672750132284904D0, &
      0.005871913283009922226995946914D0, &
      0.005861015864269402374231443531D0, &
      0.005849898211946678167061364206D0, &
      0.005838560743798747003363569519D0, &
      0.005827003885842343793022291010D0, &
      0.005815228072338094258975083051D0, &
      0.005803233745774116596194414086D0, &
      0.005791021356849213735928927349D0, &
      0.005778591364456383931702543322D0, &
      0.005765944235664991271428370112D0, &
      0.005753080445703687324787711788D0, &
      0.005740000477942362212824267687D0, &
      0.005726704823874017614981912772D0, &
      0.005713193983096204360550007806D0, &
      0.005699468463292455683300019587D0, &
      0.005685528780212967606133567244D0, &
      0.005671375457655504839782345528D0, &
      0.005657009027445287531465911712D0, &
      0.005642430029415474758425208535D0, &
      0.005627639011386637545031330632D0, &
      0.005612636529146218002106483169D0, &
      0.005597423146427572132610706035D0, &
      0.005581999434888915492813943331D0, &
      0.005566365974091757977404437696D0, &
      0.005550523351479155591270409076D0, &
      0.005534472162353648236332581689D0, &
      0.005518213009854874839810179310D0, &
      0.005501746504936822455833489443D0, &
      0.005485073266345072764971213530D0, &
      0.005468193920593387644113470003D0, &
      0.005451109101940144682774125329D0, &
      0.005433819452364725861859273692D0, &
      0.005416325621543047544315108155D0, &
      0.005398628266823572718902113365D0, &
      0.005380728053202113274344764449D0, &
      0.005362625653297344377468114374D0, &
      0.005344321747325165260222856745D0, &
      0.005325817023073333225657854939D0, &
      0.005307112175875508715272577120D0, &
      0.005288207908585203231854876549D0, &
      0.005269104931549262356427210108D0, &
      0.005249803962581399939535398147D0, &
      0.005230305726934937789185386947D0, &
      0.005210610957275768270746674204D0, &
      0.005190720393654706284192190680D0, &
      0.005170634783479783128101736622D0, &
      0.005150354881487986119514843608D0, &
      0.005129881449717141328470404460D0, &
      0.005109215257477111096773292331D0, &
      0.005088357081320884003905469228D0, &
      0.005067307705015408093862649963D0, &
      0.005046067919512328692199787383D0, &
      0.005024638522917936923894988155D0, &
      0.005003020320463469512717313847D0, &
      0.004981214124474673925202505842D0, &
      0.004959220754341320605562692947D0, &
      0.004937041036486572963271068915D0, &
      0.004914675804335549846868502755D0, &
      0.004892125898284490834178050989D0, &
      0.004869392165668924923882521227D0, &
      0.004846475460731644938072726347D0, &
      0.004823376644591045349363955808D0, &
      0.004800096585208414069756432951D0, &
      0.004776636157355448886185911306D0, &
      0.004752996242581400063165197878D0, &
      0.004729177729179922379243450337D0, &
      0.004705181512155669557029291639D0, &
      0.004681008493190663179162047669D0, &
      0.004656659580610528897937072657D0, &
      0.004632135689350181870227451952D0, &
      0.004607437740919578979259529916D0, &
      0.004582566663369058192201155322D0, &
      0.004557523391254390821014652602D0, &
      0.004532308865601840722203696998D0, &
      0.004506924033872596394023624100D0, &
      0.004481369849927314963355939881D0, &
      0.004455647273990272390353784004D0, &
      0.004429757272613176269371315641D0, &
      0.004403700818638965619467029455D0, &
      0.004377478891165111941907728266D0, &
      0.004351092475507059922912311833D0, &
      0.004324542563160944756706083325D0, &
      0.004297830151766558401393858446D0, &
      0.004270956245069621078080945864D0, &
      0.004243921852884336397282449838D0, &
      0.004216727991055227442451780462D0, &
      0.004189375681419113366110718033D0, &
      0.004161865951766540415446282708D0, &
      0.004134199835803465360173358789D0, &
      0.004106378373112003904443767510D0, &
      0.004078402609111729873458962459D0, &
      0.004050273595020140865452518142D0, &
      0.004021992387813410133046154726D0, &
      0.003993560050186265031335608455D0, &
      0.003964977650512617468603338011D0, &
      0.003936246262804875099827750518D0, &
      0.003907366966673973297796695903D0, &
      0.003878340847288519813162999128D0, &
      0.003849168995334298088578650621D0, &
      0.003819852506973011631308256852D0, &
      0.003790392483801296400619529336D0, &
      0.003760790032809268722963080833D0, &
      0.003731046266338848560462082560D0, &
      0.003701162302042068034252375597D0, &
      0.003671139262839005247551771305D0, &
      0.003640978276875699460451984990D0, &
      0.003610680477481611767159863646D0, &
      0.003580247003126992098170910950D0, &
      0.003549678997380481711154676105D0, &
      0.003518977608865717348479718041D0, &
      0.003488143991218293615136358810D0, &
      0.003457179303042459076605874557D0, &
      0.003426084707867667507319442421D0, &
      0.003394861374104690254077665301D0, &
      0.003363510475001769365471782081D0, &
      0.003332033188600574697552092474D0, &
      0.003300430697691895606804557417D0, &
      0.003268704189771169145439788650D0, &
      0.003236854856993954046573414018D0, &
      0.003204883896131119781075513586D0, &
      0.003172792508523682164511825476D0, &
      0.003140581900037948612225413569D0, &
      0.003108253281020026750902651713D0, &
      0.003075807866250348642650491726D0, &
      0.003043246874898155977795521920D0, &
      0.003010571530475542479515782546D0, &
      0.002977783060791477226514345489D0, &
      0.002944882697905871343779793392D0, &
      0.002911871678083000243575373389D0, &
      0.002878751241745274112165953184D0, &
      0.002845522633426492749991743025D0, &
      0.002812187101725080462522043945D0, &
      0.002778745899257360849748943465D0, &
      0.002745200282610227044549633391D0, &
      0.002711551512294096445698787790D0, &
      0.002677800852695407917564152100D0, &
      0.002643949572029331059747070398D0, &
      0.002609998942291816281802141475D0, &
      0.002575950239212147514084039202D0, &
      0.002541804742204615413792012646D0, &
      0.002507563734320777774911004343D0, &
      0.002473228502201043829678006603D0, &
      0.002438800336026468017908142016D0, &
      0.002404280529470125687963033556D0, &
      0.002369670379648584207510353394D0, &
      0.002334971187073220984936616773D0, &
      0.002300184255601201484958684418D0, &
      0.002265310892386644160689801453D0, &
      0.002230352407831378593050519754D0, &
      0.002195310115535779524331694290D0, &
      0.002160185332249389255493410289D0, &
      0.002124979377821471521886609324D0, &
      0.002089693575151347661178480308D0, &
      0.002054329250138731913916112504D0, &
      0.002018887731633921007318166474D0, &
      0.001983370351387804628867650436D0, &
      0.001947778444001947023567211659D0, &
      0.001912113346878267219550173728D0, &
      0.001876376400168962114978210565D0, &
      0.001840568946726033397465194241D0, &
      0.001804692332050859783151852689D0, &
      0.001768747904243635031551473702D0, &
      0.001732737013952766495436530469D0, &
      0.001696661014324110389878130789D0, &
      0.001660521260950091485333879326D0, &
      0.001624319111818701803773290493D0, &
      0.001588055927262728948823333752D0, &
      0.001551733069908424120231238419D0, &
      0.001515351904624347286962282588D0, &
      0.001478913798470224069681044909D0, &
      0.001442420120645365689757144700D0, &
      0.001405872242437510889756513421D0, &
      0.001369271537171097780430373270D0, &
      0.001332619380155811508736896087D0, &
      0.001295917148634917904354013629D0, &
      0.001259166221733550722339245453D0, &
      0.001222367980406950313532199459D0, &
      0.001185523807388666516285380403D0, &
      0.001148635087138642285956025013D0, &
      0.001111703205791432849669497784D0, &
      0.001074729551104118682389176875D0, &
      0.001037715512404510350211173098D0, &
      0.001000662480539097265105907830D0, &
      0.000963571847821184873997268916D0, &
      0.000926445007979156964772471383D0, &
      0.000889283356104514192963517161D0, &
      0.000852088288600481814569209682D0, &
      0.000814861203130772785048485662D0, &
      0.000777603498568675576864406285D0, &
      0.000740316574946985831578993853D0, &
      0.000703001833408759078253291719D0, &
      0.000665660676159933917435396200D0, &
      0.000628294506424452014331505367D0, &
      0.000590904728403224407604077406D0, &
      0.000553492747240409460780796724D0, &
      0.000516059969000759975743530816D0, &
      0.000478607800667961002377692736D0, &
      0.000441137650179552207388433693D0, &
      0.000403650926533314074063502064D0, &
      0.000366149040035628262328842863D0, &
      0.000328633402852310262977353350D0, &
      0.000291105430251488786486113725D0, &
      0.000253566543570602365847976856D0, &
      0.000216018177976967721805670597D0, &
      0.000178461805545972196102716412D0, &
      0.000140899017388190165439576518D0, &
      0.000103331903496931828490348892D0, &
      0.000065765731659236768705603660D0, &
      0.000028252637373961186168999649D0 /)

! ----------------------------------------------------------------


  ! Set up initial parameters
  integral_result = 0.0E0_C_DOUBLE
  npoints = 256 ! For 512-pt quadrature: symmetry
  
  ! Compute
  DO j = 1, npoints
    ! Adjust abscissae
    xl = ( b - a ) / 2.0E0_C_DOUBLE * absc(j) + ( b + a ) / 2.0E0_C_DOUBLE
    xu = ( a - b ) / 2.0E0_C_DOUBLE * absc(j) + ( b + a ) / 2.0E0_C_DOUBLE

    ! Evaluate
    fl = Integrands(i, xl)
    fu = Integrands(i, xu)
    integral_result = integral_result + weights(j) * ( fl + fu )
  END DO
  
  integral_result = integral_result * ( b - a ) / 2.0E0_C_DOUBLE

END SUBROUTINE GaussQuadratureq
